# AWS Roles for Avi with Terraform

Project for the terraform scripts to implement Avi roles required for configuring Avi on AWS

![AWS](https://img.shields.io/badge/AWS-%23FF9900.svg?style=flat-square&logo=amazon-aws&logoColor=white) ![Terraform](https://img.shields.io/badge/terraform-%235835CC.svg?style=flat-square&logo=terraform&logoColor=white)

## Introduction

This project contains the Terraform scripts. These have been tested in AWS environment to install Avi version 22.1.3 or later.
It contains the **iam-policies** which are a copy from the [devops](https://github.com/avinetworks/devops/tree/master/aws/iam-policies) git repo from Avi.

In the project, the `variables.tf` provides option to specify the iam policies to configure **vmimport** and **AviController-Refined-Role** role. In future, if there is any change in the refined iam-policies for Avi versions, then operators can easily add/change the iam-policies in the terraform script.

We can use the s3 bucket (as configure in `backend.tf`) as the backend and dynamoDB table for the lock file, so that we get persistence for the terraform state. The script also creates the EC2 instance profile and the roles would be available to attach with Avi-controller EC2 instance which can be provisioned from AWS Marketplace.

## Install Process

It's the usual process to apply these scripts to configure AWS roles and policies.

1. Clone the repo to local workstation
2. Change the `backend.tf` as per environment
3. Configure AWS auth with `aws configure` or environment variables.
4. Run `terraform plan` to perform plan operation and verify the terraform resources getting created.
5. Run `Terraform apply` to execute terraform scripts and create the roles and policies.

## Verification

The install can be verified from the outputs generated by terraform script with the ARNs for the roles and policies. Also, operator can verify the them in IAM.

## Contact

You can reach me on [Twitter @rajinh24](https://twitter.com/rajinh24)

## License

[![Licence](https://img.shields.io/github/license/rajks24/markdown-badges?style=flat-square&logo=github)](./LICENSE)

<hr>